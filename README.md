# Lazer_Termogramm_Monitor

*Python-пакет для обработки, визуализации и анализа термографических данных лазерной сварки*

[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/)

## Обзор

Проект **Lazer_Termogramm_Monitor** представляет собой комплексное решение для мониторинга качества лазерной сварки в режиме реального времени на основе анализа термографических последовательностей. Система реализует полный цикл обработки: от исходных видеофайлов до прогнозирования дефектов с использованием глубокого обучения.

**Ключевые возможности:**
- Извлечение и предобработка термографических данных из видео
- Нормализация и фильтрация температурных последовательностей
- Обучение CNN моделей для бинарной и многометочной классификации
- Сравнение различных архитектур нейронных сетей
- Визуализация результатов и анализ эффективности моделей

## Научная задача

Цель проекта — разработка автоматизированной системы обнаружения дефектов лазерной сварки на основе анализа термографических данных. Система позволяет:
- Обнаруживать наличие дефектов в режиме реального времени
- Классифицировать типы дефектов (линейное смещение, продольный подрез, непровар и др.)
- Обеспечивать раннее предупреждение о возможных дефектах

## Структура проекта

### **Main_process/** - Основной рабочий пайплайн
- **`1_Video_processing.ipynb`** - Извлечение термографических последовательностей из видеофайлов
- **`2_Data_processing.ipynb`** - Предобработка данных: фильтрация, нормализация, сглаживание
- **`3_Binary_classification.ipynb`** - Обучение CNN моделей для бинарной классификации (дефект/норма)
- **`4_Multilabel_classification.ipynb`** - Обучение моделей для многометочной классификации типов дефектов
- **`5_1D_CNN_2D_CNN_simple.ipynb`** - Сравнение архитектур 1D и 2D сверточных сетей

### **Data/** - Данные и датасеты
- **`Binary_CNN_data/`** - Подготовленные датасеты для бинарной классификации:
  - `X_train_cnn.npy`, `X_val_cnn.npy`, `X_test_cnn.npy` - признаки
  - `y_train.npy`, `y_val.npy`, `y_test.npy` - метки
- **`Multilabel_CNN_data/`** - Аналогичные датасеты для многометочной классификации
- **`CSV/`** - Таблицы с метаданными:
  - `merge_therm_ids_data_*.csv` - сопоставление термограмм с идентификаторами и метками
- **`Target_label/`** - Разметка данных:
  - `Labels.xlsx` - описание классов дефектов и их кодировка
- **`Therm/`** - Термографические данные:
  - `Therm_data_all_is_one/` - исходные объединенные данные
  - `*_normalized/` - нормализованные данные
  - `*_normalized_smooth/` - нормализованные и сглаженные данные
  - `Therm_data_combine_dop_split/` - финальная версия данных после обработки

### **Fin_exp_models/** - Экспериментальные архитектуры CNN
- **`1D_CNN_*/`** - Модели с одномерными свертками для обработки временных рядов:
  - `simple/` - базовая архитектура
  - `deeper/` - глубокая архитектура
  - `residual/` - архитектура с residual-блоками
  - `imbalanced/` - архитектуры для работы с несбалансированными данными
- **`2D_CNN_*/`** - Модели с двумерными свертками:
  - `simple/` - базовая 2D CNN
  - `deeper/` - глубокая 2D CNN
  - `residual/` - 2D CNN с residual-блоками
  - `standard/` - стандартные архитектуры

### **Bests_Models/** - Сохраненные лучшие модели
- **`Binary/`** - Модели для бинарной классификации
- **`Multilabel/`** - Модели для многометочной классификации

### **Debugging_Information/** - Промежуточные результаты и отладка
Файлы для проверки промежуточных этапов обработки данных

### **Progress_Streaming_Processing/** - Результаты потоковой обработки
- `df_combined_all.pkl` - объединенные данные
- `processed_thermogram_ids.pkl` - обработанные идентификаторы термограмм

### **Utilities/** - Вспомогательные модули
- `data_loader.py` - загрузка и чтение данных различных форматов
- `preprocessing.py` - функции предобработки термографических данных
- `visualization.py` - инструменты визуализации результатов
- `metrics.py` - метрики оценки качества моделей

## Быстрый старт

### Установка
```bash
# Клонирование репозитория
git clone https://github.com/gvo104/Termogramm_My.git
cd Lazer_Termogramm_Monitor

# Установка зависимостей
pip install -r requirements.txt

# (Опционально) Создание виртуального окружения
python -m venv .venv
source .venv/bin/activate  # Linux/Mac
# или .venv\Scripts\activate  # Windows
```


### Запуск полного пайплайна
```bash
# Рекомендуется выполнять ноутбуки последовательно:
# 1. Обработка видео
jupyter notebook Main_process/1_Video_processing.ipynb

# 2. Предобработка данных
jupyter notebook Main_process/2_Data_processing.ipynb

# 3. Бинарная классификация
jupyter notebook Main_process/3_Binary_classification.ipynb

# 4. Многометочная классификация
jupyter notebook Main_process/4_Multilabel_classification.ipynb

# 5. Сравнение архитектур
jupyter notebook Main_process/5_1D_CNN_2D_CNN_simple.ipynb
```

## Архитектура обработки

### 1. Извлечение данных
```
Вход: Видеофайлы (.ptw)
      ↓
[1_Video_processing.ipynb]
      ↓
Выход: Термографические последовательности (numpy arrays)
```

### 2. Предобработка
```
Вход: Сырые термограммы
      ↓
Фильтрация шумов (медианный фильтр)
      ↓
Нормализация (min-max scaling)
      ↓
Временное сглаживание (гауссов фильтр)
      ↓
[2_Data_processing.ipynb]
      ↓
Выход: Очищенные датасеты для обучения
```

### 3. Обучение моделей
```
Вход: Подготовленные датасеты
      ↓
[3_Binary_classification.ipynb] → Бинарные модели
      ↓
[4_Multilabel_classification.ipynb] → Многометочные модели
      ↓
Выход: Обученные модели CNN
```

### 4. Эксперименты и сравнение
```
Вход: Обученные модели
      ↓
[5_1D_CNN_2D_CNN_simple.ipynb]
      ↓
Сравнение эффективности архитектур
      ↓
Выбор лучших моделей
      ↓
Сохранение в Bests_Models/
```

## Научная значимость
Проект имеет следующие научные и практические аспекты:
### Теоретические аспекты:
1. Разработка методов анализа многомерных временных рядов
2. Адаптация CNN архитектур для термографических данных и анализа многомерных временных рядов
3. Исследование связи между динамикой температуры и качеством сварки

### Практические применения:
1. Мониторинг качества сварки в реальном времени
2. Раннее обнаружение дефектов на производстве
3. Снижение брака и повышение надежности сварных соединений
4. Автоматизация контроля качества
